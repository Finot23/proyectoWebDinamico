<div style="padding: 20px;">
  <h1> Dashboard General</h1>

  <div style="display: flex; gap: 20px; flex-wrap: wrap; margin-bottom: 30px;">

    <mat-card style="flex: 1; min-width: 240px; background-color: #e3f2fd;">
      <mat-card-header style="display: flex; justify-content: space-between; align-items: center;">
        <div>
          <mat-card-title style="font-size: 2rem;">{{ totalProductos }}</mat-card-title>
          <mat-card-subtitle>Productos</mat-card-subtitle>
        </div>
        <mat-icon color="primary" style="font-size: 45px; height: 45px; width: 45px;">shopping_basket</mat-icon>
      </mat-card-header>
    </mat-card>

    <mat-card style="flex: 1; min-width: 240px; background-color: #e8f5e9;">
      <mat-card-header style="display: flex; justify-content: space-between; align-items: center;">
        <div>
          <mat-card-title style="font-size: 1.8rem;">{{ totalValorInventario | currency }}</mat-card-title>
          <mat-card-subtitle>Valor Total</mat-card-subtitle>
        </div>
        <mat-icon style="color: #2e7d32; font-size: 45px; height: 45px; width: 45px;">attach_money</mat-icon>
      </mat-card-header>
    </mat-card>

    <mat-card style="flex: 1; min-width: 240px; background-color: #f3e5f5;">
      <mat-card-header style="display: flex; justify-content: space-between; align-items: center;">
        <div>
          <mat-card-title style="font-size: 2rem;">{{ totalCategorias }}</mat-card-title>
          <mat-card-subtitle>Categorías</mat-card-subtitle>
        </div>
        <mat-icon color="accent" style="font-size: 45px; height: 45px; width: 45px;">category</mat-icon>
      </mat-card-header>
    </mat-card>

    <mat-card style="flex: 1; min-width: 240px; background-color: #ffebee;">
      <mat-card-header style="display: flex; justify-content: space-between; align-items: center;">
        <div>
          <mat-card-title style="font-size: 2rem;">{{ productosBajoStock.length }}</mat-card-title>
          <mat-card-subtitle>Alertas</mat-card-subtitle>
        </div>
        <mat-icon color="warn" style="font-size: 45px; height: 45px; width: 45px;">warning</mat-icon>
      </mat-card-header>
    </mat-card>
  </div>

  <div style="display: flex; gap: 20px; flex-wrap: wrap;">

    <div style="flex: 2; min-width: 300px;">
        <mat-card style="height: 100%;">
            <mat-card-header>
                <mat-icon mat-card-avatar color="primary">bar_chart</mat-icon>
                <mat-card-title>Top 5: Mayor Inventario</mat-card-title>
                <mat-card-subtitle>Productos con más unidades disponibles</mat-card-subtitle>
            </mat-card-header>
            
            <mat-card-content style="padding-top: 20px;">
                <mat-list>
                    <ng-container *ngFor="let item of topProductos">
                        <div style="margin-bottom: 15px;">
                            <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
                                <span style="font-weight: 500;">{{ item.nombre }}</span>
                                <span style="color: gray;">{{ item.stock }} u.</span>
                            </div>
                            
                            <mat-progress-bar 
                                mode="determinate" 
                                [value]="item.porcentaje" 
                                style="height: 10px; border-radius: 5px;">
                            </mat-progress-bar>
                        </div>
                    </ng-container>

                    <div *ngIf="topProductos.length === 0" style="text-align: center; color: gray; margin-top: 20px;">
                        No hay datos suficientes.
                    </div>
                </mat-list>
            </mat-card-content>
        </mat-card>
    </div>

    <div style="flex: 1; min-width: 300px;">
        <mat-card style="height: 100%;">
            <mat-card-header>
                <mat-icon mat-card-avatar color="warn">notifications_active</mat-icon>
                <mat-card-title style="color: #d32f2f;">Stock Crítico (&lt; 5)</mat-card-title>
            </mat-card-header>
            
            <mat-card-content>
                <mat-list>
                    <ng-container *ngFor="let prod of productosBajoStock">
                        <mat-list-item>
                            <mat-icon matListItemIcon color="warn">priority_high</mat-icon>
                            <div matListItemTitle>{{ prod.nombre }}</div>
                            <div matListItemLine>
                                <span style="color: #d32f2f; font-weight: bold;">{{ prod.stockActual }} unid.</span> 
                                <span style="color: gray;"> | {{ prod.precio | currency }}</span>
                            </div>
                        </mat-list-item>
                        <mat-divider></mat-divider>
                    </ng-container>

                    <mat-list-item *ngIf="productosBajoStock.length === 0">
                        <mat-icon matListItemIcon style="color: green;">check_circle</mat-icon>
                        <div matListItemTitle>¡Excelente!</div>
                        <div matListItemLine>Inventario saludable.</div>
                    </mat-list-item>
                </mat-list>
            </mat-card-content>
        </mat-card>
    </div>

  </div>
</div>